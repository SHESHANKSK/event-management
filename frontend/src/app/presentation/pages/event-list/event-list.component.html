<div>
  <header class="mb-4">
    <h1 class="display-6 fw-bold text-dark">Event Dashboard</h1>
    <p class="text-muted mt-1">Manage and monitor all organizational events.</p>
  </header>

  <!-- Filter Controls -->
  <div class="card border-0 mb-4" style="background: transparent; box-shadow: none;">
    <div class="card-body p-0">
      <div class="row g-3">
        <div class="col-12 col-md-6 col-lg-3">
          <label for="status-filter" class="form-label small text-secondary text-uppercase fw-bold"
            style="font-size: 0.7rem;">Status</label>
          <select id="status-filter" (change)="onStatusChange($event)" class="form-select bg-white border-0 shadow-sm"
            style="height: 3rem;">
            <option value="ALL">All Statuses</option>
            @for (status of statuses; track status) {
            <option [value]="status">{{ status }}</option>
            }
          </select>
        </div>
        <div class="col-12 col-md-6 col-lg-3">
          <label for="date-from" class="form-label small text-secondary text-uppercase fw-bold"
            style="font-size: 0.7rem;">Date From</label>
          <input type="date" id="date-from" (change)="onDateFromChange($event)"
            class="form-control bg-white border-0 shadow-sm" style="height: 3rem;">
        </div>
        <div class="col-12 col-md-6 col-lg-3">
          <label for="date-to" class="form-label small text-secondary text-uppercase fw-bold"
            style="font-size: 0.7rem;">Date To</label>
          <input type="date" id="date-to" (change)="onDateToChange($event)"
            class="form-control bg-white border-0 shadow-sm" style="height: 3rem;">
        </div>
        <div class="col-12 col-md-6 col-lg-3">
          <label for="department" class="form-label small text-secondary text-uppercase fw-bold"
            style="font-size: 0.7rem;">Department</label>
          <div class="position-relative">
            <input type="text" id="department" (input)="onDepartmentChange($event)" placeholder="Search department..."
              class="form-control bg-white border-0 shadow-sm" style="height: 3rem; padding-left: 2.5rem;">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
              class="bi bi-search position-absolute text-muted" style="top: 1rem; left: 1rem;" viewBox="0 0 16 16">
              <path
                d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z" />
            </svg>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Event Table -->
  <div class="card border-0 shadow-sm overflow-hidden">
    <div class="table-responsive">
      <table class="table table-hover align-middle mb-0">
        <thead class="bg-light border-bottom">
          <tr>
            <th scope="col" class="ps-4" style="width: 30%;">Title</th>
            <th scope="col">Date</th>
            <th scope="col">Department</th>
            <th scope="col">Status</th>
            <th scope="col" class="text-center">Attendees</th>
            <th scope="col">Last Updated</th>
            <th scope="col" class="text-end pe-4">Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (event of filteredEvents(); track event.eventId) {
          <tr>
            <td class="ps-4">
              <div class="d-flex flex-column">
                <span class="fw-bold text-dark">{{ event.title }}</span>
                <span class="small text-muted text-truncate" style="max-width: 250px;">{{ event.description || 'No
                  description' }}</span>
              </div>
            </td>
            <td class="text-nowrap text-secondary">{{ formatDate(event.eventDate) }}</td>
            <td><span class="badge bg-light text-dark border fw-normal">{{ event.department }}</span></td>
            <td>
              <span class="badge rounded-pill shadow-sm" [class]="getBadgeClass(event.status)"
                style="font-weight: 600; font-size: 0.75rem;">
                {{ event.status }}
              </span>
            </td>
            <td class="text-center">
              <div class="d-inline-flex align-items-center bg-light rounded-pill px-2 py-1 border">
                <svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" fill="currentColor"
                  class="bi bi-people-fill text-muted me-1" viewBox="0 0 16 16">
                  <path d="M7 14s-1 0-1-1 1-4 5-4 5 3 5 4-1 1-1 1H7Zm4-6a3 3 0 1 0 0-6 3 3 0 0 0 0 6Z" />
                  <path fill-rule="evenodd"
                    d="M5.216 14A2.238 2.238 0 0 1 5 13c0-1.355.68-2.75 1.936-3.72A6.325 6.325 0 0 0 5 9c-4 0-5 3-5 4s1 1 1 1h4.216Z" />
                </svg>
                <span class="small fw-bold">{{ event.totalAttendees }}</span>
              </div>
            </td>
            <td class="text-nowrap small text-muted">{{ formatDate(event.updatedAt) }}</td>
            <td class="text-end pe-4">
              <div class="btn-group">
                <button (click)="viewEvent(event.eventId)" class="btn btn-sm btn-icon btn-light text-secondary me-1"
                  title="View Details">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                    viewBox="0 0 16 16">
                    <path d="M10.5 8a2.5 2.5 0 1 1-5 0 2.5 2.5 0 0 1 5 0z" />
                    <path
                      d="M0 8s3-5.5 8-5.5S16 8 16 8s-3 5.5-8 5.5S0 8 0 8zm8 3.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7z" />
                  </svg>
                </button>
                <button (click)="editEvent(event.eventId)" class="btn btn-sm btn-icon btn-light text-primary me-1"
                  title="Edit">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                    viewBox="0 0 16 16">
                    <path
                      d="M12.146.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1 0 .708l-10 10a.5.5 0 0 1-.168.11l-5 2a.5.5 0 0 1-.65-.65l2-5a.5.5 0 0 1 .11-.168l10-10zM11.207 2.5 13.5 4.793 14.793 3.5 12.5 1.207 11.207 2.5zm1.586 3L10.5 3.207 4 9.707V10h.5a.5.5 0 0 1 .5.5v.5h.5a.5.5 0 0 1 .5.5v.5h.293l6.5-6.5zm-9.761 5.175-.106.106-1.528 3.821 3.821-1.528.106-.106A.5.5 0 0 1 5 12.5V12h-.5a.5.5 0 0 1-.5-.5V11h-.5a.5.5 0 0 1-.468-.325z" />
                  </svg>
                </button>
                <button (click)="deleteEvent(event)" class="btn btn-sm btn-icon btn-light text-danger" title="Delete">
                  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor"
                    viewBox="0 0 16 16">
                    <path
                      d="M5.5 5.5A.5.5 0 0 1 6 6v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm2.5 0a.5.5 0 0 1 .5.5v6a.5.5 0 0 1-1 0V6a.5.5 0 0 1 .5-.5zm3 .5a.5.5 0 0 0-1 0v6a.5.5 0 0 0 1 0V6z" />
                    <path fill-rule="evenodd"
                      d="M14.5 3a1 1 0 0 1-1 1H13v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V4h-.5a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1H6a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1h3.5a1 1 0 0 1 1 1v1zM4.118 4 4 4.059V13a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1V4.059L11.882 4H4.118zM2.5 3V2h11v1h-11z" />
                  </svg>
                </button>
              </div>
            </td>
          </tr>
          } @empty {
          <tr>
            <td colspan="7" class="text-center text-secondary p-5">
              <div class="d-flex flex-column align-items-center">
                <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" fill="currentColor"
                  class="bi bi-calendar-x text-muted opacity-50 mb-3" viewBox="0 0 16 16">
                  <path
                    d="M6.146 7.146a.5.5 0 0 1 .708 0L8 8.293l1.146-1.147a.5.5 0 1 1 .708.708L8.707 9l1.147 1.146a.5.5 0 0 1-.708.708L8 9.707l-1.146 1.147a.5.5 0 0 1-.708-.708L7.293 9 6.146 7.854a.5.5 0 0 1 0-.708z" />
                  <path
                    d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5zM1 4v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V4H1z" />
                </svg>
                <p class="mb-0">No events found matching your criteria</p>
              </div>
            </td>
          </tr>
          }
        </tbody>
      </table>
    </div>
  </div>

  <app-confirmation-modal title="Delete Event" [message]="modalMessage()" (confirm)="confirmDeleteEvent()">
  </app-confirmation-modal>
</div>