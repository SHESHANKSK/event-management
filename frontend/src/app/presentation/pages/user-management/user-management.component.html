<div>
  <header class="d-flex align-items-center justify-content-between mb-4">
    <div>
      <h1 class="display-6 fw-bold text-dark">User Management</h1>
      <p class="text-muted mt-1">Administer users and their roles.</p>
    </div>
    <button (click)="createUser()" class="btn btn-dark fw-semibold px-3 py-2">
      Create User
    </button>
  </header>

  <!-- User Table -->
  <div class="card shadow-sm">
    <div class="table-responsive">
      <table class="table table-hover mb-0">
        <thead class="table-light">
          <tr>
            <th scope="col">Name</th>
            <th scope="col">Email</th>
            <th scope="col">Department</th>
            <th scope="col">Roles</th>
            <th scope="col" class="text-end">Actions</th>
          </tr>
        </thead>
        <tbody>
          @for (user of users(); track user.id) {
            <tr>
              <td class="fw-medium text-dark text-nowrap">{{ user.firstName }} {{ user.lastName }}</td>
              <td class="text-nowrap">{{ user.email }}</td>
              <td class="text-nowrap">{{ user.department }}</td>
              <td>
                <div class="d-flex flex-wrap gap-1">
                  @for (role of user.roles; track role) {
                    <span class="badge rounded-pill" [class]="getRoleClass(role)">
                      {{ role }}
                    </span>
                  }
                </div>
              </td>
              <td class="text-end text-nowrap">
                <button (click)="editUser(user)" class="btn btn-link btn-sm text-secondary text-decoration-none">Edit</button>
                <button (click)="deleteUser(user)" class="btn btn-link btn-sm text-danger text-decoration-none">Delete</button>
              </td>
            </tr>
          } @empty {
            <tr>
              <td colspan="5" class="text-center text-muted p-5">
                No users found.
              </td>
            </tr>
          }
        </tbody>
      </table>
    </div>
  </div>
  
  <app-confirmation-modal 
    title="Delete User" 
    [message]="modalMessage()"
    (confirm)="confirmDeleteUser()">
  </app-confirmation-modal>

  <app-user-modal
    [isEditMode]="isEditMode()"
    [user]="currentUser()"
    (save)="handleSaveUser($event)">
  </app-user-modal>
</div>